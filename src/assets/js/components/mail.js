import $ from "jquery";

const form = $('#mail');

form.on('submit', (e) => {
	console.log('asdf');
	e.preventDefault();
	const dataForm = form.serializeArray();
	const post_id = form.find('input[type=submit]').attr("data-post-id");
	console.log(post_id);
	$.ajax({
		url: true_obj.ajaxurl,
		data: {
			action: 'subscribe',
			email: dataForm[0].value,
			post_id,
		},
		method: "POST",
		
		beforeSend(xhr) {
			console.log("Идет загрузка...");
			const htmlIcon = `
				<svg width="1440" height="304" viewBox="0 0 1440 304" fill="none" xmlns="http://www.w3.org/2000/svg">
				<rect width="1440" height="304" fill="#202945"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M537.5 152.5C537.5 157.194 533.694 161 529 161C524.306 161 520.5 157.194 520.5 152.5C520.5 147.806 524.306 144 529 144C533.694 144 537.5 147.806 537.5 152.5ZM539 152.5C539 158.023 534.523 162.5 529 162.5C523.477 162.5 519 158.023 519 152.5C519 146.977 523.477 142.5 529 142.5C534.523 142.5 539 146.977 539 152.5ZM528.53 156.03L534.53 150.03L533.47 148.97L528.042 154.397L525.569 151.512L524.431 152.488L527.431 155.988L527.958 156.603L528.53 156.03Z" fill="white"/>
				<path d="M554.62 158V145.4H560.272C561.724 145.4 562.822 145.772 563.566 146.516C564.13 147.08 564.412 147.788 564.412 148.64C564.412 149.888 563.812 150.824 562.612 151.448C564.28 152.012 565.114 153.044 565.114 154.544C565.114 155.648 564.694 156.5 563.854 157.1C563.014 157.7 561.88 158 560.452 158H554.62ZM556.798 150.71H559.822C560.554 150.71 561.13 150.566 561.55 150.278C561.982 149.978 562.198 149.54 562.198 148.964C562.198 148.46 562.006 148.07 561.622 147.794C561.238 147.506 560.692 147.362 559.984 147.362H556.798V150.71ZM556.798 156.038H560.47C561.238 156.038 561.832 155.888 562.252 155.588C562.684 155.288 562.9 154.85 562.9 154.274C562.9 153.146 562.036 152.582 560.308 152.582H556.798V156.038ZM567.358 158V148.496H569.536V151.826H571.534C572.662 151.826 573.574 152.078 574.27 152.582C574.966 153.086 575.314 153.836 575.314 154.832C575.314 155.816 574.99 156.59 574.342 157.154C573.694 157.718 572.812 158 571.696 158H567.358ZM569.536 156.236H571.408C571.96 156.236 572.386 156.116 572.686 155.876C572.986 155.636 573.136 155.288 573.136 154.832C573.136 154.412 572.98 154.088 572.668 153.86C572.368 153.632 571.936 153.518 571.372 153.518H569.536V156.236ZM576.754 158V148.496H578.932V158H576.754ZM589.007 160.934C588.215 160.934 587.465 160.742 586.757 160.358L587.495 158.738C587.939 158.978 588.365 159.098 588.773 159.098C589.085 159.098 589.343 159.014 589.547 158.846C589.751 158.69 589.943 158.408 590.123 158L586.163 148.496H588.485L591.185 155.552L593.651 148.496H595.919L592.139 158.27C591.755 159.242 591.329 159.926 590.861 160.322C590.393 160.73 589.775 160.934 589.007 160.934ZM602.178 158.216C600.774 158.216 599.604 157.742 598.668 156.794C597.732 155.834 597.264 154.67 597.264 153.302V153.266C597.264 151.898 597.732 150.728 598.668 149.756C599.616 148.784 600.792 148.298 602.196 148.298C603.732 148.298 604.998 148.844 605.994 149.936L604.644 151.394C603.888 150.602 603.066 150.206 602.178 150.206C601.398 150.206 600.744 150.5 600.216 151.088C599.7 151.676 599.442 152.39 599.442 153.23V153.266C599.442 154.13 599.706 154.856 600.234 155.444C600.774 156.032 601.458 156.326 602.286 156.326C603.162 156.326 603.984 155.93 604.752 155.138L606.066 156.434C605.55 157.01 604.986 157.454 604.374 157.766C603.774 158.066 603.042 158.216 602.178 158.216ZM607.981 158V148.496H616.459V158H614.281V150.368H610.159V158H607.981ZM623.552 158.216C622.16 158.216 620.996 157.754 620.06 156.83C619.136 155.906 618.674 154.712 618.674 153.248C618.674 151.868 619.112 150.698 619.988 149.738C620.864 148.778 621.974 148.298 623.318 148.298C624.758 148.298 625.874 148.79 626.666 149.774C627.47 150.746 627.872 151.958 627.872 153.41C627.872 153.674 627.86 153.878 627.836 154.022H620.852C620.972 154.778 621.278 155.372 621.77 155.804C622.262 156.224 622.868 156.434 623.588 156.434C624.524 156.434 625.382 156.056 626.162 155.3L627.44 156.434C626.456 157.622 625.16 158.216 623.552 158.216ZM620.834 152.582H625.712C625.64 151.85 625.394 151.25 624.974 150.782C624.554 150.314 623.996 150.08 623.3 150.08C622.64 150.08 622.088 150.314 621.644 150.782C621.2 151.238 620.93 151.838 620.834 152.582ZM630.059 158V148.496H632.237V156.128H635.747V148.496H637.907V156.128H641.417V148.496H643.595V158H630.059ZM646.337 158V148.496H648.515V152.348H652.709V148.496H654.887V158H652.709V154.166H648.515V158H646.337ZM662.14 158.216C660.7 158.216 659.5 157.736 658.54 156.776C657.58 155.816 657.1 154.646 657.1 153.266C657.1 151.886 657.586 150.716 658.558 149.756C659.53 148.784 660.736 148.298 662.176 148.298C663.616 148.298 664.816 148.778 665.776 149.738C666.748 150.698 667.234 151.874 667.234 153.266C667.234 154.634 666.748 155.804 665.776 156.776C664.804 157.736 663.592 158.216 662.14 158.216ZM662.176 156.326C663.04 156.326 663.736 156.032 664.264 155.444C664.792 154.856 665.056 154.13 665.056 153.266C665.056 152.414 664.78 151.694 664.228 151.106C663.676 150.506 662.98 150.206 662.14 150.206C661.288 150.206 660.598 150.5 660.07 151.088C659.542 151.676 659.278 152.402 659.278 153.266C659.278 154.106 659.554 154.826 660.106 155.426C660.658 156.026 661.348 156.326 662.176 156.326ZM674.848 158V148.496H683.326V158H681.148V150.368H677.026V158H674.848ZM690.581 158.216C689.141 158.216 687.941 157.736 686.981 156.776C686.021 155.816 685.541 154.646 685.541 153.266C685.541 151.886 686.027 150.716 686.999 149.756C687.971 148.784 689.177 148.298 690.617 148.298C692.057 148.298 693.257 148.778 694.217 149.738C695.189 150.698 695.675 151.874 695.675 153.266C695.675 154.634 695.189 155.804 694.217 156.776C693.245 157.736 692.033 158.216 690.581 158.216ZM690.617 156.326C691.481 156.326 692.177 156.032 692.705 155.444C693.233 154.856 693.497 154.13 693.497 153.266C693.497 152.414 693.221 151.694 692.669 151.106C692.117 150.506 691.421 150.206 690.581 150.206C689.729 150.206 689.039 150.5 688.511 151.088C687.983 151.676 687.719 152.402 687.719 153.266C687.719 154.106 687.995 154.826 688.547 155.426C689.099 156.026 689.789 156.326 690.617 156.326ZM696.795 160.286V156.128H697.821C698.529 154.712 698.883 152.558 698.883 149.666V148.496H706.245V156.128H707.595L707.307 160.286H705.489V158H698.829L698.613 160.286H696.795ZM700.053 156.128H704.067V150.368H700.935V151.628C700.935 153.392 700.641 154.892 700.053 156.128ZM709.407 158V148.496H717.885V158H715.707V150.368H711.585V158H709.407ZM720.622 158V148.496H722.746V154.868C724.738 152.036 726.238 149.912 727.246 148.496H729.298V158H727.192V151.664L722.674 158H720.622ZM736.422 158.216C735.018 158.216 733.848 157.742 732.912 156.794C731.976 155.834 731.508 154.67 731.508 153.302V153.266C731.508 151.898 731.976 150.728 732.912 149.756C733.86 148.784 735.036 148.298 736.44 148.298C737.976 148.298 739.242 148.844 740.238 149.936L738.888 151.394C738.132 150.602 737.31 150.206 736.422 150.206C735.642 150.206 734.988 150.5 734.46 151.088C733.944 151.676 733.686 152.39 733.686 153.23V153.266C733.686 154.13 733.95 154.856 734.478 155.444C735.018 156.032 735.702 156.326 736.53 156.326C737.406 156.326 738.228 155.93 738.996 155.138L740.31 156.434C739.794 157.01 739.23 157.454 738.618 157.766C738.018 158.066 737.286 158.216 736.422 158.216ZM750.199 158H748.039V156.83C747.271 157.742 746.245 158.198 744.961 158.198C744.013 158.198 743.209 157.94 742.549 157.424C741.901 156.896 741.577 156.164 741.577 155.228C741.577 154.208 741.931 153.434 742.639 152.906C743.347 152.378 744.277 152.114 745.429 152.114C746.353 152.114 747.229 152.246 748.057 152.51V152.33C748.057 151.67 747.853 151.166 747.445 150.818C747.049 150.47 746.473 150.296 745.717 150.296C744.853 150.296 743.947 150.494 742.999 150.89L742.405 149.144C743.581 148.616 744.787 148.352 746.023 148.352C747.403 148.352 748.441 148.7 749.137 149.396C749.845 150.092 750.199 151.082 750.199 152.366V158ZM748.093 154.562V154.022C747.445 153.77 746.719 153.644 745.915 153.644C745.231 153.644 744.697 153.776 744.313 154.04C743.929 154.304 743.737 154.676 743.737 155.156C743.737 155.588 743.911 155.93 744.259 156.182C744.607 156.434 745.045 156.56 745.573 156.56C746.305 156.56 746.905 156.374 747.373 156.002C747.853 155.63 748.093 155.15 748.093 154.562ZM752.718 158.108C752.37 158.108 751.944 158.066 751.44 157.982L751.602 156.2C751.794 156.248 752.004 156.272 752.232 156.272C752.484 156.272 752.688 156.236 752.844 156.164C753.012 156.092 753.18 155.912 753.348 155.624C753.528 155.324 753.666 154.904 753.762 154.364C753.858 153.824 753.936 153.068 753.996 152.096C754.056 151.112 754.086 149.912 754.086 148.496H761.268V158H759.09V150.368H756.12C756.12 151.724 756.066 152.876 755.958 153.824C755.85 154.772 755.706 155.522 755.526 156.074C755.358 156.626 755.118 157.058 754.806 157.37C754.506 157.67 754.2 157.868 753.888 157.964C753.576 158.06 753.186 158.108 752.718 158.108ZM764.005 158V148.496H766.129V154.868C768.121 152.036 769.621 149.912 770.629 148.496H772.681V158H770.575V151.664L766.057 158H764.005ZM779.805 158.216C778.401 158.216 777.231 157.742 776.295 156.794C775.359 155.834 774.891 154.67 774.891 153.302V153.266C774.891 151.898 775.359 150.728 776.295 149.756C777.243 148.784 778.419 148.298 779.823 148.298C781.359 148.298 782.625 148.844 783.621 149.936L782.271 151.394C781.515 150.602 780.693 150.206 779.805 150.206C779.025 150.206 778.371 150.5 777.843 151.088C777.327 151.676 777.069 152.39 777.069 153.23V153.266C777.069 154.13 777.333 154.856 777.861 155.444C778.401 156.032 779.085 156.326 779.913 156.326C780.789 156.326 781.611 155.93 782.379 155.138L783.693 156.434C783.177 157.01 782.613 157.454 782.001 157.766C781.401 158.066 780.669 158.216 779.805 158.216ZM785.608 158V148.496H787.786V151.826H789.964C791.092 151.826 792.004 152.078 792.7 152.582C793.396 153.086 793.744 153.836 793.744 154.832C793.744 155.816 793.42 156.59 792.772 157.154C792.124 157.718 791.242 158 790.126 158H785.608ZM787.786 156.236H789.838C790.39 156.236 790.816 156.116 791.116 155.876C791.416 155.636 791.566 155.288 791.566 154.832C791.566 154.412 791.41 154.088 791.098 153.86C790.798 153.632 790.366 153.518 789.802 153.518H787.786V156.236ZM801.042 158V148.496H803.22V152.348H807.414V148.496H809.592V158H807.414V154.166H803.22V158H801.042ZM820.301 158H818.141V156.83C817.373 157.742 816.347 158.198 815.063 158.198C814.115 158.198 813.311 157.94 812.651 157.424C812.003 156.896 811.679 156.164 811.679 155.228C811.679 154.208 812.033 153.434 812.741 152.906C813.449 152.378 814.379 152.114 815.531 152.114C816.455 152.114 817.331 152.246 818.159 152.51V152.33C818.159 151.67 817.955 151.166 817.547 150.818C817.151 150.47 816.575 150.296 815.819 150.296C814.955 150.296 814.049 150.494 813.101 150.89L812.507 149.144C813.683 148.616 814.889 148.352 816.125 148.352C817.505 148.352 818.543 148.7 819.239 149.396C819.947 150.092 820.301 151.082 820.301 152.366V158ZM818.195 154.562V154.022C817.547 153.77 816.821 153.644 816.017 153.644C815.333 153.644 814.799 153.776 814.415 154.04C814.031 154.304 813.839 154.676 813.839 155.156C813.839 155.588 814.013 155.93 814.361 156.182C814.709 156.434 815.147 156.56 815.675 156.56C816.407 156.56 817.007 156.374 817.475 156.002C817.955 155.63 818.195 155.15 818.195 154.562ZM828.288 160.88V148.496H830.466V150.08C831.306 148.892 832.38 148.298 833.688 148.298C834.888 148.298 835.926 148.748 836.802 149.648C837.678 150.536 838.116 151.742 838.116 153.266C838.116 154.766 837.678 155.966 836.802 156.866C835.926 157.754 834.888 158.198 833.688 158.198C832.38 158.198 831.306 157.64 830.466 156.524V160.88H828.288ZM833.184 156.308C833.952 156.308 834.594 156.026 835.11 155.462C835.638 154.898 835.902 154.154 835.902 153.23C835.902 152.33 835.638 151.598 835.11 151.034C834.582 150.47 833.94 150.188 833.184 150.188C832.428 150.188 831.774 150.476 831.222 151.052C830.682 151.628 830.412 152.366 830.412 153.266C830.412 154.154 830.682 154.886 831.222 155.462C831.774 156.026 832.428 156.308 833.184 156.308ZM848.321 158H846.161V156.83C845.393 157.742 844.367 158.198 843.083 158.198C842.135 158.198 841.331 157.94 840.671 157.424C840.023 156.896 839.699 156.164 839.699 155.228C839.699 154.208 840.053 153.434 840.761 152.906C841.469 152.378 842.399 152.114 843.551 152.114C844.475 152.114 845.351 152.246 846.179 152.51V152.33C846.179 151.67 845.975 151.166 845.567 150.818C845.171 150.47 844.595 150.296 843.839 150.296C842.975 150.296 842.069 150.494 841.121 150.89L840.527 149.144C841.703 148.616 842.909 148.352 844.145 148.352C845.525 148.352 846.563 148.7 847.259 149.396C847.967 150.092 848.321 151.082 848.321 152.366V158ZM846.215 154.562V154.022C845.567 153.77 844.841 153.644 844.037 153.644C843.353 153.644 842.819 153.776 842.435 154.04C842.051 154.304 841.859 154.676 841.859 155.156C841.859 155.588 842.033 155.93 842.381 156.182C842.729 156.434 843.167 156.56 843.695 156.56C844.427 156.56 845.027 156.374 845.495 156.002C845.975 155.63 846.215 155.15 846.215 154.562ZM855.303 158.216C853.899 158.216 852.729 157.742 851.793 156.794C850.857 155.834 850.389 154.67 850.389 153.302V153.266C850.389 151.898 850.857 150.728 851.793 149.756C852.741 148.784 853.917 148.298 855.321 148.298C856.857 148.298 858.123 148.844 859.119 149.936L857.769 151.394C857.013 150.602 856.191 150.206 855.303 150.206C854.523 150.206 853.869 150.5 853.341 151.088C852.825 151.676 852.567 152.39 852.567 153.23V153.266C852.567 154.13 852.831 154.856 853.359 155.444C853.899 156.032 854.583 156.326 855.411 156.326C856.287 156.326 857.109 155.93 857.877 155.138L859.191 156.434C858.675 157.01 858.111 157.454 857.499 157.766C856.899 158.066 856.167 158.216 855.303 158.216ZM865.498 158.216C864.094 158.216 862.924 157.742 861.988 156.794C861.052 155.834 860.584 154.67 860.584 153.302V153.266C860.584 151.898 861.052 150.728 861.988 149.756C862.936 148.784 864.112 148.298 865.516 148.298C867.052 148.298 868.318 148.844 869.314 149.936L867.964 151.394C867.208 150.602 866.386 150.206 865.498 150.206C864.718 150.206 864.064 150.5 863.536 151.088C863.02 151.676 862.762 152.39 862.762 153.23V153.266C862.762 154.13 863.026 154.856 863.554 155.444C864.094 156.032 864.778 156.326 865.606 156.326C866.482 156.326 867.304 155.93 868.072 155.138L869.386 156.434C868.87 157.01 868.306 157.454 867.694 157.766C867.094 158.066 866.362 158.216 865.498 158.216ZM871.302 158V148.496H873.48V151.826H875.478C876.606 151.826 877.518 152.078 878.214 152.582C878.91 153.086 879.258 153.836 879.258 154.832C879.258 155.816 878.934 156.59 878.286 157.154C877.638 157.718 876.756 158 875.64 158H871.302ZM873.48 156.236H875.352C875.904 156.236 876.33 156.116 876.63 155.876C876.93 155.636 877.08 155.288 877.08 154.832C877.08 154.412 876.924 154.088 876.612 153.86C876.312 153.632 875.88 153.518 875.316 153.518H873.48V156.236ZM880.698 158V148.496H882.876V158H880.698ZM885.538 158.108C885.19 158.108 884.764 158.066 884.26 157.982L884.422 156.2C884.614 156.248 884.824 156.272 885.052 156.272C885.304 156.272 885.508 156.236 885.664 156.164C885.832 156.092 886 155.912 886.168 155.624C886.348 155.324 886.486 154.904 886.582 154.364C886.678 153.824 886.756 153.068 886.816 152.096C886.876 151.112 886.906 149.912 886.906 148.496H894.088V158H891.91V150.368H888.94C888.94 151.724 888.886 152.876 888.778 153.824C888.67 154.772 888.526 155.522 888.346 156.074C888.178 156.626 887.938 157.058 887.626 157.37C887.326 157.67 887.02 157.868 886.708 157.964C886.396 158.06 886.006 158.108 885.538 158.108ZM896.825 158V148.496H898.985V153.05L903.125 148.496H905.681L901.991 152.492L905.987 158H903.413L900.533 154.076L898.985 155.714V158H896.825ZM909.439 160.934C908.647 160.934 907.897 160.742 907.189 160.358L907.927 158.738C908.371 158.978 908.797 159.098 909.205 159.098C909.517 159.098 909.775 159.014 909.979 158.846C910.183 158.69 910.375 158.408 910.555 158L906.595 148.496H908.917L911.617 155.552L914.083 148.496H916.351L912.571 158.27C912.187 159.242 911.761 159.926 911.293 160.322C910.825 160.73 910.207 160.934 909.439 160.934Z" fill="white"/>
				</svg>
			`

			const htmlSubscribe = `<p style="text-align:center">${htmlIcon}</p>`;
			$('.questions.questions--subscribe').html(htmlSubscribe);
		},
		success(result) {
			const htmlSubscribe = `
				<div class="container">
					<form method="POST" id="mail" class="questions__wrapper">
						<div class="questions__title">Подпишись 
							<div class="text-accent">На проект</div>
						</div>
						<div class="fc">
							<div class="questions__description">Укажите адрес электронной почты, на который вы хотели бы  получать уведомления об изменениях на донном объекте</div>
							<div class="form__field">
								<div class="inputbox">
								<span class="wpcf7-form-control-wrap text-phone">
									<input type="text" required="required" name="text-phone" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" id="input20" aria-required="true" aria-invalid="false">
									<label for="input20">Email</label>
									<span class="underline"></span>
								</span>
								</div>
							</div>
						</div>
						<div class="questions__buttons">
							<input type="submit" value="Подписаться" class="btn-primary" data-post-id="1942">
						</div>
					</form>
				</div>
			`;
			console.log("итог", result);
			// const response = JSON.parse(result);
			// console.log(response);
			$('.questions.questions--subscribe').html(htmlSubscribe);
		}
	})

}) 



